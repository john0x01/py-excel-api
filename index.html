<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requisição</title>
</head>
<body>
    <h1>Requisição</h1>
    <script>
        const dataBody = 
        {
            currencyFormat: ["valor"],
            data: [
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1379 - FULANO DE TAL",
                    "valor": 838196.12,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1376 - FULANO DE TAL",
                    "valor": 31008.92,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1376 - FULANO DE TAL",
                    "valor": 81601.03,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1376 - FULANO DE TAL",
                    "valor": 199316.19,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1377 - FULANO DE TAL",
                    "valor": 0,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1380 - FULANO DE TAL",
                    "valor": 34546.74,
                },
                {
                    "data": "23/04/2023",
                    "tipo": "DINHEIRO",
                    "lancamentos": "1381 - FULANO DE TAL",
                    "valor": 0,
                },
                {
                    "data": "03/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "000000987 - VALE S.A",
                    "valor": -600,
                },
                {
                    "data": "10/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "131212312312 - FULANO DE TAL",
                    "valor": 700,
                },
                {
                    "data": "16/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "131212312312 - FULANO DE TAL",
                    "valor": 850,
                },
                {
                    "data": "20/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "131212312312 - FULANO DE TAL",
                    "valor": 1000,
                },
                {
                    "data": "03/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "00000384 - FORNECEDOR 123",
                    "valor": -510,
                },
                {
                    "data": "18/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "00000384 - FORNECEDOR 123",
                    "valor": -510,
                },
                {
                    "data": "13/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "000000054 - FORNECEDOR 123",
                    "valor": -156,
                },
                {
                    "data": "28/04/2023",
                    "tipo": "CARTÃO",
                    "lancamentos": "000000054 - FORNECEDOR 123",
                    "valor": -156,
                }
            ]
        }


        async function request() {
            const response = await fetch('http://localhost:5000/export', {
                method: 'POST',
                mode: 'cors',
                body: JSON.stringify(dataBody),
                headers: {
                    'Content-Type': 'application/json'
                }
            })

            return response
        }

        request()
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(new Blob([blob]));
                const a = document.createElement('a');
                a.href = url;
                a.download = 'arquivo.xlsx';
                document.body.appendChild(a);
                a.click();
                a.remove();
            })
            .catch(error => console.error(error));
            // .then(response => console.log(response))
    </script>
</body>
</html>